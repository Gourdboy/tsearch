/*! tsearch - v1.0 - 2013-06-26 3:00:33 AM
* Copyright (c) 2013 舒克; Licensed  */
KISSY.add(function(a,b,c,d,e){var f=437,g=380,h=152,i=30,j=function(){j.superclass.constructor.apply(this,arguments),this.initializer()};return a.extend(j,a.Base,{initializer:function(){this.isInited=!1,this.renderUI(),this.bindUI()},renderUI:function(){this.overlay=new b({width:h,height:i}),this.overlay.set("content",'<div class="J_Pi_Search_TripSearchFixedBtn trip-search-fixed-btn"><a href="http://trip.taobao.com">\u5b9a\u5236\u6211\u7684\u65c5\u884c</a></div><div class="J_Pi_Search_TripSearchFixedContent trip-search-fixed-content"></div>'),this.overlay.render(),this.overlay.show();var a=this.overlay.get("el");a.addClass("trip-search-fixed-box"),this.contentNode=a.one(".J_Pi_Search_TripSearchFixedContent"),this.btnNode=a.one(".J_Pi_Search_TripSearchFixedBtn")},bindUI:function(){this.on("afterVisibleChange",function(a){a.newVal?(0==this.isInited&&(this.createSearch(),this.isInited=!0),this.show()):this.hide()}),this.on("afterTabIndexChange",function(a){this.slide.go(a.newVal)},this),a.Event.on(this.btnNode,"click",function(a){a.preventDefault(),this.get("visible")?this.set("visible",!1):this.set("visible",!0)},this),a.Event.on(window,"scroll",a.buffer(function(){this.get("visible")&&this.set("visible",!1)},300,this),this),6===a.UA.ie&&a.Event.on(window,"scroll",a.buffer(function(){this.overlay.get("el")[0].className=this.overlay.get("el")[0].className},100,this),this)},createSearch:function(){this.contentNode.html(d.searchTemplate),this.slide=new e("J_Pi_Search_SearchModule",{navClass:"J_Pi_Search_SearchTabNav",contentClass:"search-bd",pannelClass:"J_Pi_Search_TabPannel",eventype:"click"});var a=["createFlightSearch","createIflightSearch","createHotelSearch","createLodgeSearch","createTicketSearch","createTravelSearch","createCarSearch"];this.slide.on("switch",function(b){var d=a[b.index];""!=d&&(c[d].call(this),a[b.index]="")}),c[a[this.get("tabIndex")]].call(this),a[this.get("tabIndex")]="",this.slide.go(this.get("tabIndex"))},show:function(){this.overlay.set("width",f),this.overlay.set("height",g+i),this.btnNode.addClass("trip-search-fixed-btn-open")},hide:function(){this.overlay.set("width",h),this.overlay.set("height",i),this.btnNode.removeClass("trip-search-fixed-btn-open")}},{ATTRS:{tabIndex:{value:0},visible:{value:!1}}}),j},{requires:["overlay","./index","./template","gallery/slide/1.1/index","node","event","base","./fixed-btn.css"]});