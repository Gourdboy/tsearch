/*! tsearch - v1.1 - 2013-07-26 1:37:13 PM
* Copyright (c) 2013 舒克; Licensed  */
KISSY.add("gallery/tsearch/1.1/common",function(){var a={subString:function(a,b){var c=/[^\x00-\xff]/g;if(!a)return"";if(a.replace(c,"mm").length<=b)return a;for(var d=Math.floor(b/2),e=d;e<a.length;e++)if(a.substr(0,e).replace(c,"mm").length>=b)return a.substr(0,e);return a},stringLen:function(a){return a?a.replace(/[^\x00-\xff]/g,"rr").length:""},cutStr:function(b,c,d){return d=d||"...",a.stringLen(b)>c?a.subString(b,c-4)+d:b},buildObjCutAttr:function(b,c,d){b[c+"_sub"]=a.cutStr(b[c],d)},singleDateToDouble:function(a){return a.toString().length>1?a.toString():"0"+a.toString()},strToDate:function(a){var b=a.split("-");return new Date(b[0],b[1]-1,b[2])},getDateInterval:function(b,c){return parseInt(Math.abs(a.strToDate(c)-a.strToDate(b))/1e3/60/60/24)},formatDate:function(b){var c=new Date(b),d=a.singleDateToDouble,e=c.getFullYear(),f=d(c.getMonth()+1),g=d(c.getDate()),h=d(c.getHours()),i=d(c.getMinutes());return{mmdd:f+"-"+g,yymmdd:e+"-"+f+"-"+g,hhMM:h+":"+i,yy:e,mm:f,dd:g,hh:h,MM:i}},setDate:function(a,b){return new Date(a.getTime()+864e5*b)},timeToDuration:function(a){a/=1e3;var b=Math.floor(a/3600),c=Math.floor((a-3600*b)/60),d=a%60;return{h:b,s:c,m:d}},html2text:function(a){var b=document.createElement("div");b.innerHTML=a;try{return"string"==typeof b.innerText?b.innerText:b.textContent}catch(c){return a}}};return a}),KISSY.add("gallery/tsearch/1.1/trip-autocomplete",function(a,b,c){var d={node:null,points:["bl","tl"],overflow:{adjustX:!1,adjustY:!0}};return{flight:function(c){var e={source:"http://s.jipiao.trip.taobao.com/city_search.do?lines={maxResults}&q={query}",resultListLocator:function(b){b=b.result;var c=[];return a.each(b,function(b){if(b.hasAirport)c.push(b);else{var d=b.nearCity;a.each(d,function(d){var e=a.mix(d,{nearCity:b.cityName});c.push(e)})}}),c},resultTextLocator:"cityName",activeFirstItem:!0,align:d,hotSource:"http://www.taobao.com/go/rgn/trip/chinahotcity_jsonp.php",resultFormatter:function(b,c){var d=[],e='<div class="ks-ac-item-inner"><span class="ks-ac-name">{cityname}</span><span class="ks-ac-intro">{py}</span></div>',f="";for(var g in c){var h=c[g];if(h.raw.nearCity){var i='<div class="ks-ac-item"><div class="ks-ac-near-tip">"'+h.raw.nearCity+'"&nbsp;\u6ca1\u6709\u673a\u573a</div>',j='<div class="ks-ac-item-inner ks-ac-item-inner-sub"><span class="ks-ac-name">\u90bb\u8fd1\u673a\u573a\uff1a{cityName}&nbsp;--&nbsp;\u8ddd\u79bb{distance}\u516c\u91cc</span></div>',k=a.substitute(j,{cityName:h.text,distance:h.raw.distance});h.raw.nearCity!=f?(i+=k+"</div>",f=h.raw.nearCity):i=k,d.push(i)}else d.push(a.substitute(e,{cityname:h.text,py:h.raw.py}))}return d}};c=a.merge(e,c);var f=new b(c),g=f.get("codeInputNode");return g=g instanceof a.NodeList?g:a.one(g),g&&f.on("select",function(a){g.val(a.result.raw.cityCode)}),f},iflight:function(c){var e={source:"http://ijipiao.trip.taobao.com/ie/remote/auto_complete.do?flag=4&count=10&callback={callback}&q={query}",resultListLocator:"result",resultTextLocator:"cityName",activeFirstItem:!0,align:d,hotSource:"http://www.taobao.com/go/rgn/trip/international_jsonp.php"};c=a.merge(e,c);var f=new b(c),g=f.get("codeInputNode");return g=g instanceof a.NodeList?g:a.one(g),g&&f.on("select",function(a){g.val(a.result.raw.cityCode)}),f},hotel:function(e){function f(b){var c=b.result,d=[];return a.isArray(c)&&c.length&&a.map(c,function(a){var b=a.t.split("_");d.push({cityName:b[0],cityCode:a.c,py:b[1]})}),d}function g(b,d){return a.map(d,function(b){var d=b.raw;return a.substitute('<div class="ks-ac-item-inner"><span class="ks-ac-name">{cityName}</span><span class="ks-ac-intro">{py}</span></div>',{cityName:c.cutStr(d.cityName,20),py:c.cutStr(d.py,10)})})}var h={activeFirstItem:!0,align:d,resultListLocator:f,resultFormatter:g,source:"http://kezhan.trip.taobao.com/citysuggest.do?t=0&q={query}",hotSource:"http://www.taobao.com/go/rgn/trip/hotelhotcityv2_jsonp.php"};e=a.merge(h,e);var i=new b(e),j=i.get("codeInputNode");return j=j instanceof a.NodeList?j:a.one(j),j&&i.on("select",function(a){j.val(a.result.raw.cityCode)}),i},travel:function(c){function e(a){return a}function f(b,c){return a.map(c,function(c){var c=c.raw,d=c.cityName.split("-");return a.substitute(h,{first:e(d[0],b),second:e(d[1],b)?"&nbsp;-&nbsp;"+e(d[1],b):""})})}var g=document.domain.indexOf("daily.taobao.net")>1,h='<div class="ks-ac-item-inner"><span class="ks-ac-name">{first}</span><span class="ks-ac-intro" style="color:#999;float:left;">{second}</span></div>';_dep_citycodeUrl=(g?"http://dujia.trip.daily.taobao.net/":"http://dujia.trip.taobao.com/")+"sell/ajax/get_sug_city.htm?max=10";var i={activeFirstItem:!0,align:d,resultListLocator:"result",resultTextLocator:"cityName",resultFormatter:f,source:_dep_citycodeUrl+"&q={query}",hotSource:"http://www.taobao.com/go/rgn/trip/dujiadephotcity_jsonp.php"};c=a.merge(i,c);var j=new b(c),k=j.get("codeInputNode");return k=k instanceof a.NodeList?k:a.one(k),k&&j.on("select",function(a){k.val(a.result.raw.cityCode)}),j},city:function(c){var e={source:"http://s.jipiao.trip.taobao.com/city_search.do?lines={maxResults}&q={query}",resultListLocator:"result",resultTextLocator:"cityName",activeFirstItem:!0,align:d,hotSource:"http://www.taobao.com/go/rgn/trip/chinahotcity_jsonp.php"};c=a.merge(e,c);var f=new b(c),g=f.get("codeInputNode");return g=g instanceof a.NodeList?g:a.one(g),g&&f.on("select",function(a){g.val(a.result.raw.cityCode)}),f}}},{requires:["gallery/autocomplete/1.1/index","./common","node","event","base"]}),KISSY.add("gallery/tsearch/1.1/radio-button",function(a){function b(){b.superclass.constructor.apply(this,arguments),this.initializer()}return a.extend(b,a.Base,{initializer:function(){var a=this.node=this.get("node"),b=this;this.items={},this.radios=a.all('input[type="radio"]'),this.radios.each(function(c){var d={input:c},e=c.attr("id");e&&a.one("label[for="+e+"]")&&(d.label=a.one("label[for="+e+"]")),b.items[c.val()]=d}),this.bindUI(),this.set("value",this.val())},bindUI:function(){this.node.delegate("click","label",function(b){var c=a.one(b.currentTarget);a.one("#"+c.attr("for")).attr("checked",!0),this.set("value",this.node.one("#"+c.attr("for")).val())},this),this.on("afterValueChange",this._syncUI,this)},_syncUI:function(a){var b=this.items,c=b[a.newVal],d=b[a.prevVal],e=this.get("selectedClass");d&&d.label.removeClass(e),c&&c.label.addClass(e)},val:function(){return arguments.length<1?this._getValue():this._setValue.apply(this,arguments)},_getValue:function(){var b=a.one("input[type=radio][checked=checked]");return b?b.val():void 0},_setValue:function(a){var b=this.items[a];b&&(b.input.attr("checked",!0),this.set("value",a))}},{ATTRS:{node:{value:"",setter:function(b){return b instanceof a.NodeList?b:a.one(b)}},name:{value:""},selectedClass:{value:"selected"},value:{value:null}}}),b},{requires:["node","event","base","sizzle"]}),KISSY.add("gallery/tsearch/1.1/tsearch",function(a,b,c,d,e,f){function g(a){var b=this;g.superclass.constructor.call(b,a),this.initializer()}var h={TripAutocomplete:c,Calendar:e,Placeholder:f,Tradio:d};return a.extend(g,b,{initializer:function(){return this.form=this.get("form"),this.form?(this.fields=this.get("fields"),a.each(this.fields,function(b,c){var d=this.form.one(c);return d?(b.node=d,b.val&&b.node.val(b.val),this.bindWidgets(b),b.autoSwitch&&this.setSwitchInput(c),void 0):(a.log(c+"is not find.."),!1)},this),this.bindEvent(),void 0):(a.log("TSearch:\u6ca1\u6709\u627e\u5230\u8868\u5355\u8282\u70b9,\u521d\u59cb\u5316\u5931\u8d25"),void 0)},bindEvent:function(){this.form.on("submit",this._doSubmit,this),this.get("switchSearchType")&&this.initRadioSwitch();var b=this.get("swapper");b&&a.Event.on(b.trigger,"click",function(a){a.halt(),this.swap()},this)},addField:function(){},bindWidgets:function(b){var c=this;a.each(b.widgets,function(d,e){var f=h[e];f&&("TripAutocomplete"==e?a.each(b.widgets[e],function(a,c){b[e]=f[c](a)}):b[e]=new f(d),"Calendar"===e&&d.finalTriggerNode&&c.fields[d.finalTriggerNode]&&(c.fields[d.finalTriggerNode][e]=b[e]))}),b.showTip=function(a){return a.TripAutocomplete?function(b){a.node[0].focus(),a.TripAutocomplete.showMessage(b)}:a.Calendar?function(b){a.node[0].focus(),a.Calendar.set("message",b),a.Calendar.showMessage(b)}:void 0}(b)},swap:function(){a.each(this.get("swapper").list,function(a,b){this._swapItem(b,a)},this)},_swapItem:function(a,b){var c;a=this.fields[a],b=this.fields[b],c=a.node.val(),a.node.val(b.node.val()),b.node.val(c)},setSwitchInput:function(a){return!1},initRadioSwitch:function(){var b=this.get("switchSearchType"),c=this.fields,d=(a.one(b.back_container),c[b.back_input].node),e=c[b.trigger].Tradio,f=c[b.go_input].Calendar;return e?(e.on("afterValueChange",function(a){"0"===a.newVal&&(d.val(""),f.currentNode=d,f._setDateInfo("")),this._setSearchType(a.newVal)},this),d.on("valuechange",function(a){""===a.newVal&&e.val("0")}),f.on("dateclick",function(){this.currentNode.attr("id")===b.back_input.replace("#","")&&e.val("1")}),this._setSearchType(e.val()),void 0):this},_setSearchType:function(b){var c=this.get("switchSearchType"),d=this.fields,e=a.one(c.back_container);"1"===b?(e.removeClass("disabled"),d[c.go_input].autoSwitch&&(d[c.back_input].disabled=!1)):(e.addClass("disabled"),d[c.go_input].autoSwitch&&(d[c.back_input].disabled=!0))},_doSubmit:function(a){return this.validate()?(this.fire("submit",{form:this.form,fields:this.fields}),void 0):(a.preventDefault(),!1)},_isResetDate:function(a){return a=a.split("-"),new Date>new Date(a[0],a[1]-1,a[2])},getDate:function(a){function b(a){return a+="",1==a.length?"0"+a:a}a=a||0;var c,d,e,f=new Date;return f.setDate(f.getDate()+a),c=f.getFullYear(),d=b(f.getMonth()+1),e=b(f.getDate()),[c,d,e].join("-")},validate:function(){var a,b,c,d,e,f,g,h=this.fields,i=this,j=!0;for(b=0,d=this.get("validation_order"),e=d.length;e>b&&(a=d[b],h[a].validation&&j&&!h[a].disabled);b++){for(c=0,f=h[a].validation,g=f.length;g>c;c++){var k=f[c];if(!i._validateRule(k,h[a])){i.fire("validate",{rule:k,field:h[a]}),"function"==typeof k.onValidateFailure?k.onValidateFailure.call(h[a],k):h[a].showTip&&h[a].showTip(k.tip),j=!1;break}}if(0==j)break}return j},_validateRule:function(a,b){var c=function(a){var b=a.split("-");return new Date(b[0],b[1]-1,b[2])};switch(a.type){case"required":return""!=b.node.val();case"dateformat":var d=b.node.val();return 10==d.length&&/(([0-9]{3}[1-9]|[0-9]{2}[1-9][0-9]{1}|[0-9]{1}[1-9][0-9]{2}|[1-9][0-9]{3})-(((0[13578]|1[02])-(0[1-9]|[12][0-9]|3[01]))|((0[469]|11)-(0[1-9]|[12][0-9]|30))|(02-(0[1-9]|[1][0-9]|2[0-8]))))|((([0-9]{2})(0[48]|[2468][048]|[13579][26])|((0[48]|[2468][048]|[3579][26])00))-02-29)/.test(d);case"mindate":var e,d=b.node.val(),f=c(d);return e="string"==typeof a.minDate?c(this.fields[a.minDate].node.val()):a.minDate,f>=e;case"identical":var d=b.node.val(),g=this.fields[a.identicalWidth];return d!=g.node.val();case"custom":return"function"==typeof a.validateFn?a.validateFn.call(b,a.arg,this):!0}return!0}},{ATTRS:{form:{value:"",setter:function(b){return b instanceof a.NodeList?b:a.one(b)}},fields:{value:{"#J_FlightDepCity":{input_node:null,widgets:{Placeholder:{inputNode:null},TripAutocompleteV2:{}},validation:[{blur:[{required:""}]}]}}},validate_order:{value:[]},swapper:{value:{trigger:"#J_Pi_Search_FlightSwap",children:{from:"to"}}},switchSearchType:{value:null},storage:{value:!1},validation_order:{value:null}}}),g},{requires:["base","./trip-autocomplete","./radio-button","gallery/calendar/1.1/index","gallery/placeholder/1.0/index","node","base"]}),KISSY.add("gallery/tsearch/1.1/index",function(a,b){var c={createFlightSearch:function(){return new b({form:".J_FlightForm",fields:{".J_Radio":{widgets:{Tradio:{node:".J_Radio",name:"tripType"}}},".J_DepCity":{val:"",widgets:{TripAutocomplete:{flight:{inputNode:".J_DepCity",codeInputNode:".J_DepCityCode"}},Placeholder:{node:".J_DepCity"}},autoSwitch:{nextField:".J_ArrCity"},validation:[{type:"required",when:"blur",tip:"\u8bf7\u586b\u5199\u51fa\u53d1\u57ce\u5e02"}]},".J_DepCityCode":{},".J_ArrCity":{widgets:{TripAutocomplete:{flight:{inputNode:".J_ArrCity",codeInputNode:".J_ArrCityCode"}},Placeholder:{node:".J_ArrCity"}},validation:[{type:"required",when:"blur",tip:"\u8bf7\u586b\u5199\u5230\u8fbe\u57ce\u5e02"},{type:"identical",identicalWidth:".J_DepCity",tip:"\u51fa\u53d1\u5230\u8fbe\u57ce\u5e02\u4e0d\u80fd\u76f8\u540c"}]},".J_ArrCityCode":{},".J_DepDate":{widgets:{Placeholder:{node:".J_DepDate"},Calendar:{triggerNode:".J_DepDate",finalTriggerNode:".J_EndDate",minDate:new Date,isDateInfo:1,isDateIcon:1,afterDays:364,isKeyup:!1,isHoliday:1}},validation:[{type:"required",tip:"\u8bf7\u586b\u5199\u51fa\u53d1\u65e5\u671f"},{type:"dateformat",tip:"\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u65e5\u671f\u683c\u5f0f \u5982\uff1a2018-01-01"},{type:"mindate",minDate:new Date-864e5,tip:"\u51fa\u53d1\u65e5\u671f\u4e0d\u80fd\u65e9\u4e8e\u4eca\u5929"}],autoSwitch:{active:!0,nextField:".J_EndDate"}},".J_EndDate":{disabled:!0,widgets:{Placeholder:{node:".J_EndDate"}},validation:[{type:"required",tip:"\u8bf7\u586b\u5199\u8fd4\u7a0b\u65e5\u671f"},{type:"dateformat",tip:"\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u65e5\u671f\u683c\u5f0f \u5982\uff1a2018-01-01"},{type:"mindate",minDate:".J_DepDate",tip:"\u8fd4\u7a0b\u65e5\u671f\u4e0d\u80fd\u65e9\u4e8e\u51fa\u53d1\u65e5\u671f"}]}},validation_order:[".J_DepCity",".J_ArrCity",".J_DepDate",".J_ArrDate"],swapper:{trigger:".J_Swap",list:{".J_DepCity":".J_ArrCity",".J_DepCityCode":".J_ArrCityCode"}},switchSearchType:{trigger:".J_Radio",back_container:".J_EndField",go_input:".J_DepDate",back_input:".J_EndDate"},storage:!0})},createIflightSearch:function(){return new b({form:"#J_Pi_Search_ijipiao_form",fields:{"#J_Pi_Search_IFlightRadio":{widgets:{Tradio:{node:"#J_Pi_Search_IFlightRadio",name:"_fmie.ie._0.t"}}},"#J_Pi_Search_ijipiao_depCity":{widgets:{TripAutocomplete:{iflight:{inputNode:"#J_Pi_Search_ijipiao_depCity",codeInputNode:"#J_Pi_Search_ijipiao_depCity_code",hotSource:"http://www.taobao.com/go/rgn/trip/chinahotcity_jsonp.php"}},Placeholder:{node:"#J_Pi_Search_ijipiao_depCity"}},autoSwitch:{active:!0,nextField:"#J_Pi_Search_ijipiao_arrCity"},validation:[{type:"required",when:"blur",tip:"\u8bf7\u586b\u5199\u51fa\u53d1\u57ce\u5e02"}]},"#J_Pi_Search_ijipiao_depCity_code":{},"#J_Pi_Search_ijipiao_arrCity":{widgets:{TripAutocomplete:{iflight:{inputNode:"#J_Pi_Search_ijipiao_arrCity",codeInputNode:"#J_Pi_Search_ijipiao_arrCity_code"}},Placeholder:{node:"#J_Pi_Search_ijipiao_arrCity"}},validation:[{type:"required",tip:"\u8bf7\u586b\u5199\u5230\u8fbe\u57ce\u5e02"},{type:"identical",identicalWidth:"#J_Pi_Search_ijipiao_depCity",tip:"\u51fa\u53d1\u5230\u8fbe\u57ce\u5e02\u4e0d\u80fd\u76f8\u540c"}]},"#J_Pi_Search_ijipiao_arrCity_code":{},"#J_Pi_Search_IFlightArrDate":{disabled:!0,widgets:{Placeholder:{node:"#J_Pi_Search_IFlightArrDate"}},validation:[{type:"required",tip:"\u8bf7\u586b\u5199\u8fd4\u7a0b\u65e5\u671f"},{type:"dateformat",tip:"\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u65e5\u671f\u683c\u5f0f \u5982\uff1a2018-01-01"},{type:"mindate",minDate:"#J_Pi_Search_IFlightDepDate",tip:"\u8fd4\u7a0b\u65e5\u671f\u4e0d\u80fd\u65e9\u4e8e\u51fa\u53d1\u65e5\u671f"}]},"#J_Pi_Search_IFlightDepDate":{widgets:{Placeholder:{node:"#J_Pi_Search_IFlightDepDate"},Calendar:{triggerNode:"#J_Pi_Search_IFlightDepDate",finalTriggerNode:"#J_Pi_Search_IFlightArrDate",minDate:new Date,isDateInfo:1,isDateIcon:1,isKeyup:!1,afterDays:364,isHoliday:1}},validation:[{type:"required",tip:"\u8bf7\u586b\u5199\u51fa\u53d1\u65e5\u671f"},{type:"dateformat",tip:"\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u65e5\u671f\u683c\u5f0f \u5982\uff1a2018-01-01"},{type:"mindate",minDate:new Date-864e5,tip:"\u51fa\u53d1\u65e5\u671f\u4e0d\u80fd\u65e9\u4e8e\u4eca\u5929"}],autoSwitch:{active:!0,nextField:"#J_Pi_Search_IFlightArrDate"}}},validation_order:["#J_Pi_Search_ijipiao_depCity","#J_Pi_Search_ijipiao_arrCity","#J_Pi_Search_IFlightDepDate","#J_Pi_Search_IFlightArrDate"],swapper:{trigger:"#J_Pi_Search_IFlightSwap",list:{"#J_Pi_Search_ijipiao_depCity":"#J_Pi_Search_ijipiao_arrCity","#J_Pi_Search_ijipiao_depCity_code":"#J_Pi_Search_ijipiao_arrCity_code"}},switchSearchType:{trigger:"#J_Pi_Search_IFlightRadio",back_container:"#J_Pi_Search_IFlightBackField",go_input:"#J_Pi_Search_IFlightDepDate",back_input:"#J_Pi_Search_IFlightArrDate"},storage:!0})},createHotelSearch:function(){a.use("gallery/tsearch/1.0/hotel-search",function(a,b){b({form:"#J_Pi_Search_HotelForm",radio:"#J_Pi_Search_HotelLocationRadio",radioName:"_fmd.h._0.r",HotelToCity:"#J_Pi_Search_HotelToCity",HotelDepDate:"#J_Pi_Search_HotelDepDate",HotelEndDate:"#J_Pi_Search_HotelEndDate",Omni:"#J_Pi_Search_OmniCode",HotelSearchKeywords:"#J_Pi_Search_HotelSearchKeywords"})})},createLodgeSearch:function(){a.use("gallery/tsearch/1.0/hotel-search",function(a,b){b({form:"#J_Pi_Search_LodgeForm",radioName:"_fmd.h._0.r",HotelToCity:"#J_Pi_Search_LodgeToCity",HotelDepDate:"#J_Pi_Search_LodgeDepDate",HotelEndDate:"#J_Pi_Search_LodgeEndDate",Omni:"#J_Pi_Search_LodgeOmniCode",HotelSearchKeywords:"#J_Pi_Search_LodgeSearchKeywords"})})},createTravelSearch:function(){return new b({form:"#J_Pi_Search_dujia_form",fields:{"#J_Pi_Search_dujia_depCity":{widgets:{Placeholder:{node:"#J_Pi_Search_dujia_depCity"},TripAutocomplete:{travel:{inputNode:"#J_Pi_Search_dujia_depCity"}}}},"#J_Pi_Search_dujia_arrCity":{widgets:{Placeholder:{node:"#J_Pi_Search_dujia_arrCity"},TripAutocomplete:{travel:{inputNode:"#J_Pi_Search_dujia_arrCity"}}},validation:[{type:"required",tip:"\u8bf7\u8f93\u5165\u76ee\u7684\u5730"}]}},validation_order:["#J_Pi_Search_dujia_arrCity"]})},createTicketSearch:function(){return new b({form:"#J_Pi_Search_menpiao_form",fields:{"#J_Pi_Search_menpiao_arrCity":{widgets:{Placeholder:{node:"#J_Pi_Search_menpiao_arrCity"}},validation:[{type:"required",onValidateFailure:function(){this.node[0].focus()}}]}},validation_order:["#J_Pi_Search_menpiao_arrCity"]})},createCarSearch:function(){return new b({form:"#J_Pi_Search_zuche_form",fields:{"#J_Pi_Search_zuche_arrCity":{widgets:{Placeholder:{node:"#J_Pi_Search_zuche_arrCity"},TripAutocomplete:{city:{inputNode:"#J_Pi_Search_zuche_arrCity"}}},validation:[{type:"required",tip:"\u8bf7\u586b\u5199\u79df\u8f66\u57ce\u5e02"}]}},validation_order:["#J_Pi_Search_zuche_arrCity"]})}};return c},{requires:["./tsearch","node","event","base"]}),KISSY.add("gallery/tsearch/1.1/template",function(){return{searchTemplate:'<div class="mod-search" id="J_Pi_Search_SearchModule"><div class="search-hd"><div class="search-nav"><ul class="J_Pi_Search_SearchTabNav"><li class="swing-slice-indicator J_Pi_Search_NavItemFlight selected"><s class="search-nav-flight"></s><a href="http://trip.taobao.com/jipiao" hidefocus="true">\u56fd\u5185\u673a\u7968</a></li><li class="swing-slice-indicator J_Pi_Search_NavItemIFlight"><s class="search-nav-iflight"></s><a href="http://trip.taobao.com/ijipiao" hidefocus="true">\u56fd\u9645 &#8226 \u6e2f\u6fb3\u53f0</a></li><li class="swing-slice-indicator J_Pi_Search_NavItemHotel"><s class="search-nav-hotel"></s><a href="http://trip.taobao.com/jiudian" hidefocus="true">\u9152\u5e97</a></li><li class="swing-slice-indicator J_Pi_Search_NavItemLodge"><s class="search-nav-lodge"></s><a href="http://trip.taobao.com/kezhan" hidefocus="true">\u5ba2\u6808</a></li><li class="swing-slice-indicator J_Pi_Search_NavItemTicket"><s class="search-nav-ticket"></s><a href="http://trip.taobao.com/menpiao" hidefocus="true">\u666f\u70b9\u95e8\u7968</a></li><li class="swing-slice-indicator J_Pi_Search_NavItemTravel"><s class="search-nav-travel"></s><a href="http://trip.taobao.com/dujia" hidefocus="true">\u65c5\u6e38\u5ea6\u5047</a></li><li class="swing-slice-indicator J_Pi_Search_NavItemCar"><s class="search-nav-car"></s><a href="http://trip.taobao.com/zuche" hidefocus="true">\u79df\u8f66</a></li></ul></div></div><div class="search-bd"><div class="search-item swing-slice J_Pi_Search_TabPannel"><form method="get" target="_blank" action="http://s.jipiao.trip.taobao.com/flight_search_result.htm"class="search-form search-jipiao" id="J_Pi_Search_jipiao_form"><a href="javascript:void(0)" target="_self" class="search-trade" id="J_Pi_Search_FlightSwap">\u4e92\u6362\u51fa\u53d1\u5230\u8fbe\u57ce\u5e02</a><fieldset><input type="hidden" name="spm" value="181.1113091.a1z0v.1"/><div class="search-field"><label class="search-item-intro search-tit">\u51fa\u53d1\u57ce\u5e02\uff1a</label><div class="search-inputarea"><input type="text" class="search-input required" name="depCityName" id="J_Pi_Search_jipiao_depCity" placeholder="\u57ce\u5e02\u540d" value=""/><input name="depCity" type="hidden" id="J_Pi_Search_jipiao_depCity_code" data-trade="J_Pi_Search_jipiao_arrCity_code"/></div></div><div class="search-field"><label class="search-item-intro search-tit">\u5230\u8fbe\u57ce\u5e02\uff1a</label><div class="search-inputarea"><input type="text" class="search-input required" name="arrCityName"id="J_Pi_Search_jipiao_arrCity" placeholder="\u57ce\u5e02\u540d" value="" data-description="\u5230\u8fbe\u57ce\u5e02"/><input name="arrCity" type="hidden" id="J_Pi_Search_jipiao_arrCity_code"/></div></div><div class="search-field"><label class="search-item-intro search-tit">\u822a\u7a0b\u7c7b\u578b\uff1a</label><div class="search-inputarea"><div class="search-radio" id="J_Pi_Search_FlightRadio"><label for="J_Pi_Search_jipiao_FlightTypeRadio_1" class="flight-type-radio first-label"><input type="radio" name="tripType" id="J_Pi_Search_jipiao_FlightTypeRadio_1" class="J_Pi_Search_type_radio" value="0" checked="checked"/>\u5355\u7a0b</label><label for="J_Pi_Search_jipiao_FlightTypeRadio_2" class="flight-type-radio last-label"><input type="radio" name="tripType" id="J_Pi_Search_jipiao_FlightTypeRadio_2" class="J_Pi_Search_type_radio" value="1"/>\u5f80\u8fd4</label></div></div></div><div class="search-field"><label class="search-item-intro search-tit">\u51fa\u53d1\u65e5\u671f\uff1a</label><div class="search-inputarea"><input type="text" class="search-input required dateformat J_Pi_Search_DateInput J_Pi_Search_depDate" name="depDate" id="J_Pi_Search_FlightDepDate" placeholder="yyyy-mm-dd" value="" autocomplete="off" /></div></div><div class="search-field disabled" id="J_Pi_Search_FlightBackField"><label class="search-item-intro search-tit">\u8fd4\u7a0b\u65e5\u671f\uff1a</label><div class="search-inputarea"><input type="text" class="search-input J_Pi_Search_DateInput J_Pi_Search_endDate" name="arrDate" maxlength="10" id="J_Pi_Search_FlightArrDate" placeholder="yyyy-mm-dd" value="" autocomplete="off" /></div></div><div class="search-submitarea"><button type="submit" class="search-submit-btn">\u641c\u7d22</button></div></fieldset></form></div><div class="search-item swing-slice J_Pi_Search_TabPannel hidden"><form method="get" target="_blank" action="http://s.ijipiao.trip.taobao.com/ie/flight_search.htm"class="search-form search-jipiao" id="J_Pi_Search_ijipiao_form"><input type="hidden" name="spm" value="181.1113091.a1z0v.2"/><a href="javascript:void(0)" target="_self" class="search-trade" id="J_Pi_Search_IFlightSwap">\u4e92\u6362\u51fa\u53d1\u5230\u8fbe\u57ce\u5e02</a><fieldset><div class="search-field"><label class="search-item-intro search-tit">\u51fa\u53d1\u57ce\u5e02\uff1a</label><div class="search-inputarea"><input type="text" class="search-input required" name="_fmie.ie._0.st"id="J_Pi_Search_ijipiao_depCity" placeholder="\u57ce\u5e02\u540d" value=""data-trade="J_Pi_Search_ijipiao_arrCity" data-autotab="J_Pi_Search_ijipiao_arrCity"data-description="\u51fa\u53d1\u57ce\u5e02"/><input name="_fmie.ie._0.s" type="hidden" id="J_Pi_Search_ijipiao_depCity_code"data-trade="J_Pi_Search_ijipiao_arrCity_code"/></div></div><div class="search-field"><label class="search-item-intro search-tit">\u5230\u8fbe\u57ce\u5e02\uff1a</label><div class="search-inputarea"><input type="text" class="search-input required" name="_fmie.ie._0.en"id="J_Pi_Search_ijipiao_arrCity" placeholder="\u57ce\u5e02\u540d" value="" data-description="\u5230\u8fbe\u57ce\u5e02"/><input name="_fmie.ie._0.e" type="hidden" id="J_Pi_Search_ijipiao_arrCity_code"/></div></div><div class="search-field"><label class="search-item-intro search-tit">\u822a\u7a0b\u7c7b\u578b\uff1a</label><div class="search-inputarea"><div class="search-radio" id="J_Pi_Search_IFlightRadio"><label for="J_Pi_Search_ijipiao_FlightTypeRadio_1" class="flight-type-radio first-label"><input type="radio" name="_fmie.ie._0.t" id="J_Pi_Search_ijipiao_FlightTypeRadio_1" class="J_Pi_Search_type_radio" value="0"/>\u5355\u7a0b</label><label for="J_Pi_Search_ijipiao_FlightTypeRadio_2" class="flight-type-radio last-label"><input type="radio" name="_fmie.ie._0.t" id="J_Pi_Search_ijipiao_FlightTypeRadio_2" class="J_Pi_Search_type_radio" value="1" checked="checked"/>\u5f80\u8fd4</label></div></div></div><div class="search-field"><label class="search-item-intro search-tit">\u51fa\u53d1\u65e5\u671f\uff1a</label><div class="search-inputarea"><input type="text" class="search-input required dateformat J_Pi_Search_DateInput J_Pi_Search_depDate" name="_fmie.ie._0.sta" id="J_Pi_Search_IFlightDepDate" placeholder="yyyy-mm-dd" value="" autocomplete="off" /></div></div><div class="search-field" id="J_Pi_Search_IFlightBackField"><label class="search-item-intro search-tit">\u8fd4\u7a0b\u65e5\u671f\uff1a</label><div class="search-inputarea"><input type="text" class="search-input J_Pi_Search_DateInput J_Pi_Search_endDate J_Pi_Search_ieEndDate required" name="_fmie.ie._0.end" id="J_Pi_Search_IFlightArrDate" placeholder="yyyy-mm-dd" value="" autocomplete="off" /></div></div><div class="search-submitarea"><button type="submit" class="search-submit-btn">\u641c\u7d22</button></div></fieldset></form></div><div class="search-item swing-slice J_Pi_Search_TabPannel hidden"><form method="get" target="_blank" id="J_Pi_Search_HotelForm" action="http://kezhan.trip.taobao.com/hotel_list2.htm" class="search-form search-jiudian"><input type="hidden" name="spm" value="181.1113091.a1z0v.3"/><input type="hidden" id="J_Pi_Search_HotelSearchAction" name="action" value="hotel_list_action2"/><input type="hidden" id="J_Pi_Search_HotelSearchDoSearch" name="event_submit_do_search" value="submit"/><fieldset><div class="search-field"><div class="search-radio" id="J_Pi_Search_HotelLocationRadio"><label for="J_Pi_Search_HotelLocal" class="first-label"><input id="J_Pi_Search_HotelLocal" type="radio" value="0" name="_fmd.h._0.r" checked="checked" class="flight-type-radio">\u56fd\u5185/\u6e2f\u6fb3\u53f0</label><label for="J_Pi_Search_HotelInternational" class="last-label"><input id="J_Pi_Search_HotelInternational" type="radio" value="1" name="_fmd.h._0.r" class="flight-type-radio">\u6d77\u5916</label></div></div><div class="search-field"><label class="search-item-intro search-tit J_Pi_Search_HotelToPlaceIndicator">\u76ee\u7684\u57ce\u5e02\uff1a</label><div class="search-inputarea"><input type="text" class="search-input required" id="J_Pi_Search_HotelToCity"placeholder="\u57ce\u5e02\u540d" name="city" value="" data-description="\u76ee\u7684\u57ce\u5e02"/><input name="c" type="hidden" id="J_Pi_Search_OmniCode" value=""/></div></div><div class="search-field"><label class="search-item-intro search-tit">\u5165\u4f4f\u65e5\u671f\uff1a</label><div class="search-inputarea"><div id="J_Pi_Search_jiudian_depDateBox" class="cal-input"><input type="text" class="search-input required dateformat J_Pi_Search_depDate"name="_fmd.h._0.ch" id="J_Pi_Search_HotelDepDate" placeholder="yyyy-mm-dd"value="" autocomplete="off"/></div></div></div><div class="search-field"><label class="search-item-intro search-tit">\u79bb\u5e97\u65e5\u671f\uff1a</label><div class="search-inputarea"><div id="J_Pi_Search_jiudian_endDateBox" class="cal-input"><input type="text" class="search-input required dateformat J_Pi_Search_endDate"name="_fmd.h._0.che" id="J_Pi_Search_HotelEndDate" placeholder="yyyy-mm-dd"value="" autocomplete="off"/></div></div></div><div class="search-field"><label class="search-item-intro search-tit">\u3000\u5173\u952e\u5b57\uff1a</label><div class="search-inputarea"><input type="text" class="search-input" name="_fmd.h._0.n" id="J_Pi_Search_HotelSearchKeywords" placeholder="\u8f93\u5165\u9152\u5e97\u540d\u3001\u5546\u5708\u3001\u5730\u6807\u7b49" value=""/></div></div><div class="search-submitarea"><button type="submit" class="J_Pi_Search_HotelListSearch search-submit-btn">\u641c\u7d22</button></div></fieldset></form></div><div class="search-item swing-slice J_Pi_Search_TabPannel hidden"><form method="get" target="_blank" id="J_Pi_Search_LodgeForm" action="http://kezhan.trip.taobao.com/hotel_list2.htm" class="search-form search-jiudian"><input type="hidden" name="spm" value="181.1113091.a1z0v.4"/><input type="hidden" id="J_Pi_Search_LodgeSearchAction" name="action" value="hotel_list_action2"/><input type="hidden" id="J_Pi_Search_LodgeSearchDoSearch" name="event_submit_do_search" value="submit"/><input type="hidden" name="from" value="kezhan"/><input type="hidden" name="searchBy" value="trip-kezhan"/><input type="hidden" name="_fmd.h._0.l" value="0"/><fieldset><div class="search-field"><label class="search-item-intro search-tit J_Pi_Search_HotelToPlaceIndicator">\u76ee\u7684\u57ce\u5e02\uff1a</label><div class="search-inputarea"><input type="text" class="search-input required" id="J_Pi_Search_LodgeToCity"placeholder="\u57ce\u5e02\u540d" name="city" value="" data-description="\u76ee\u7684\u57ce\u5e02"/><input name="c" type="hidden" id="J_Pi_Search_LodgeOmniCode" value=""/><input type="text" class="search-input required hidden" id="J_Pi_Search_LodgeToOversea"placeholder="\u57ce\u5e02\u540d" value="" data-description="\u76ee\u7684\u57ce\u5e02"/></div></div><div class="search-field"><label class="search-item-intro search-tit">\u5165\u4f4f\u65e5\u671f\uff1a</label><div class="search-inputarea"><div id="J_Pi_Search_LodgeDepDateBox" class="cal-input"><input type="text" class="search-input required dateformat J_Pi_Search_depDate"name="_fmd.h._0.ch" id="J_Pi_Search_LodgeDepDate" placeholder="yyyy-mm-dd"value="" data-autotab="J_Pi_Search_LodgeEndDate" autocomplete="off"/></div></div></div><div class="search-field"><label class="search-item-intro search-tit">\u79bb\u5e97\u65e5\u671f\uff1a</label><div class="search-inputarea"><div id="J_Pi_Search_LodgeEndDateBox" class="cal-input"><input type="text" class="search-input required dateformat J_Pi_Search_endDate"name="_fmd.h._0.che" id="J_Pi_Search_LodgeEndDate" placeholder="yyyy-mm-dd"value="" autocomplete="off"/></div></div></div><div class="search-field"><label class="search-item-intro search-tit">\u3000\u5173\u952e\u5b57\uff1a</label><div class="search-inputarea"><input type="text" class="search-input" name="_fmd.h._0.n" id="J_Pi_Search_LodgeSearchKeywords" placeholder="\u8f93\u5165\u9152\u5e97\u540d\u3001\u5546\u5708\u3001\u5730\u6807\u7b49" value=""/></div></div><div class="search-submitarea"><button type="submit" class="J_Pi_Search_HotelListSearch search-submit-btn">\u641c\u7d22</button></div></fieldset></form></div><div class="search-item swing-slice J_Pi_Search_TabPannel hidden"><form method="get" action="http://s.taobao.com/search?commend=all&tab=coefp&cd=false&ssid=s5-e&fs=1&bcoffset=2&cat=50037979&from=compass&navlog=compass-1-c-50037979" class="search-form search-menpiao" target="_blank" id="J_Pi_Search_menpiao_form"><fieldset><input type="hidden" name="cat" value="50037979"/><input type="hidden" name="spm" value="181.1113091.a1z0v.5"/><div class="search-field"><label class="search-tit">\u641c\u7d22\u95e8\u7968\uff1a</label><div class="search-inputarea"><input type="text" class="search-input required" name="q" id="J_Pi_Search_menpiao_arrCity" placeholder="\u666f\u70b9\u540d\u6216\u57ce\u5e02\u540d" value=""/></div></div><div class="search-submitarea"><button type="submit" class="search-submit-btn">\u641c\u7d22</button></div></fieldset></form></div><div class="search-item swing-slice J_Pi_Search_TabPannel hidden"><form method="get" target="_blank" id="J_Pi_Search_dujia_form" action="http://dujia.trip.taobao.com/search.htm"class="search-form search-dujia"><fieldset><input type="hidden" name="spm" value="181.1113091.a1z0v.6"/><div class="search-field"><label class="search-item-intro search-tit">\u51fa\u53d1\u57ce\u5e02\uff1a</label><div class="search-inputarea"><input type="text" class="search-input required" name="cq" id="J_Pi_Search_dujia_depCity"placeholder="\u57ce\u5e02\u540d" value=""/></div></div><div class="search-field"><label class="search-item-intro search-tit">\u3000\u76ee\u7684\u5730\uff1a</label><div class="search-inputarea"><input type="text" class="search-input required" name="mq" id="J_Pi_Search_dujia_arrCity"placeholder="\u666f\u70b9\u540d\u6216\u57ce\u5e02\u540d" value=""/></div></div><div class="search-submitarea"><button type="submit" class="search-submit-btn">\u641c\u7d22</button></div></fieldset></form></div><div class="search-item swing-slice J_Pi_Search_TabPannel hidden"><form method="get" action="http://s.taobao.com/search?commend=all&tab=coefp&cd=false&ssid=s5-e&fs=1&bcoffset=1&bcoffset=2&cat=50036351&from=compass&navlog=compass-7-c-50036351" class="search-form search-zuche" target="_blank" id="J_Pi_Search_zuche_form"><fieldset><input type="hidden" name="cat" value="50036351"/><input type="hidden" name="spm" value="181.1113091.a1z0v.7"/><div class="search-field"><div class="search-inputarea"><label class="search-item-intro search-tit" for="J_Pi_Search_zuche_arrCity">\u79df\u8f66\u57ce\u5e02\uff1a</label><input type="text" class="search-input required" name="q" id="J_Pi_Search_zuche_arrCity"placeholder="\u57ce\u5e02\u540d" value=""/></div></div><div class="search-submitarea"><button type="submit" class="search-submit-btn">\u641c\u7d22</button></div></fieldset></form></div></div></div>'}
}),KISSY.add("gallery/tsearch/1.1/fixed-btn",function(a,b,c,d,e){var f=437,g=380,h=152,i=30,j="\u641c\u7d22\u66f4\u591a\u5546\u54c1",k=function(){k.superclass.constructor.apply(this,arguments),this.initializer()};return a.extend(k,a.Base,{initializer:function(){this.isInited=!1,this.renderUI(),this.bindUI()},renderUI:function(){this.overlay=new b({width:h,height:i,zIndex:this.get("zIndex")}),this.overlay.set("content",'<div class="J_Pi_Search_TripSearchFixedBtn trip-search-fixed-btn"><a href="http://trip.taobao.com">'+j+'</a></div><div class="J_Pi_Search_TripSearchFixedContent trip-search-fixed-content"></div>'),this.overlay.render(),this.overlay.show();var a=this.overlay.get("el");a.addClass("trip-search-fixed-box"),this.contentNode=a.one(".J_Pi_Search_TripSearchFixedContent"),this.btnNode=a.one(".J_Pi_Search_TripSearchFixedBtn")},bindUI:function(){this.on("afterVisibleChange",function(a){a.newVal?(0==this.isInited&&(this.createSearch(),this.isInited=!0),this.show()):this.hide()}),this.on("afterTabIndexChange",function(a){this.slide.go(a.newVal)},this),a.Event.on(this.btnNode,"click",function(a){a.preventDefault(),this.get("visible")?this.set("visible",!1):this.set("visible",!0)},this),a.Event.on(window,"scroll",a.buffer(function(){this.get("visible")&&this.set("visible",!1)},300,this),this),6===a.UA.ie&&a.Event.on(window,"scroll",a.buffer(function(){this.overlay.get("el")[0].className=this.overlay.get("el")[0].className},100,this),this)},createSearch:function(){this.contentNode.html(d.searchTemplate),this.slide=new e("J_Pi_Search_SearchModule",{navClass:"J_Pi_Search_SearchTabNav",contentClass:"search-bd",pannelClass:"J_Pi_Search_TabPannel",eventype:"click"});var a=["createFlightSearch","createIflightSearch","createHotelSearch","createLodgeSearch","createTicketSearch","createTravelSearch","createCarSearch"];this.slide.on("switch",function(b){var d=a[b.index];""!=d&&(c[d].call(this),a[b.index]="")}),c[a[this.get("tabIndex")]].call(this),a[this.get("tabIndex")]="",this.slide.go(this.get("tabIndex"))},show:function(){this.overlay.set("width",f),this.overlay.set("height",g+i),this.btnNode.addClass("trip-search-fixed-btn-open")},hide:function(){this.overlay.set("width",h),this.overlay.set("height",i),this.btnNode.removeClass("trip-search-fixed-btn-open")}},{ATTRS:{zIndex:{value:1e4},tabIndex:{value:0},visible:{value:!1}}}),k},{requires:["overlay","./index","./template","gallery/slide/1.1/index","node","event","base","./fixed-btn.css"]});